import random
import math

# --- Objective Function (Simplified Solar Power Model) ---
# P = I * cos(θ - β)
# where θ = sun angle (fixed for simplicity), β = tilt angle to optimize
def solar_power(beta):
    I = 1000  # solar irradiance (W/m²)
    theta = 45  # average sun elevation angle
    power = I * math.cos(math.radians(theta - beta))
    return power

# --- GWO Parameters ---
num_wolves = 5
max_iter = 20
dim = 1  # only one variable (tilt angle)
lower_bound, upper_bound = 0, 90  # tilt angle range

# --- Initialize Wolves (Random Angles) ---
wolves = [random.uniform(lower_bound, upper_bound) for _ in range(num_wolves)]

def fitness(beta):
    return -solar_power(beta)  # negative because GWO minimizes fitness

# --- Initialize Alpha, Beta, Delta ---
alpha = beta = delta = wolves[0]
alpha_score = beta_score = delta_score = float("inf")

# --- Main Loop ---
for iteration in range(max_iter):
    for wolf in wolves:
        score = fitness(wolf)

        if score < alpha_score:
            alpha, alpha_score = wolf, score
        elif score < beta_score:
            beta, beta_score = wolf, score
        elif score < delta_score:
            delta, delta_score = wolf, score

    a = 2 - iteration * (2 / max_iter)

    new_wolves = []
    for wolf in wolves:
        r1, r2 = random.random(), random.random()
        A1 = 2 * a * r1 - a
        C1 = 2 * r2
        D_alpha = abs(C1 * alpha - wolf)
        X1 = alpha - A1 * D_alpha

        r1, r2 = random.random(), random.random()
        A2 = 2 * a * r1 - a
        C2 = 2 * r2
        D_beta = abs(C2 * beta - wolf)
        X2 = beta - A2 * D_beta

        r1, r2 = random.random(), random.random()
        A3 = 2 * a * r1 - a
        C3 = 2 * r2
        D_delta = abs(C3 * delta - wolf)
        X3 = delta - A3 * D_delta

        new_wolf = (X1 + X2 + X3) / 3
        new_wolf = max(min(new_wolf, upper_bound), lower_bound)
        new_wolves.append(new_wolf)

    wolves = new_wolves

# --- Output ---
optimal_tilt = alpha
max_power = solar_power(optimal_tilt)

print("☀️ Optimal Tilt Angle:", round(optimal_tilt, 2), "degrees")
print("⚡ Maximum Power Output:", round(max_power, 2), "W/m²")
